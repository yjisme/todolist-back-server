# api 接口说明

## 通用说明

所有的api接口均遵循以下规则：

- 所有的请求地址均为以`/api`开头

- 消息体格式建议使用`application/json`

- 所有的接口均会返回`json`格式的对象，并且格式统一如下：

  ```json
  {
    "code": number, // 错误消息码，0表示没有错误，如果要判断是否有错误，应使用此字段进行判断
    "detail": any, // 错误的详细信息，若没有错误，则为null
    "data": any, // 具体的响应信息，若有错误，则为null
  }
  ```

- **统一的错误消息码**

  当发生错误时，http 响应码也会做出相应改变

  - 422：验证错误

    如果发生验证错误，比如添加用户时，填写的信息有误，则会按照下面的格式返回消息：

    ```json
    {
      "code": 422,
      "detail": [ // 错误的详细信息
        {"message": "loginId is required", "field": "loginId" }
      ],
      "data": null // 由于发生了错误，因此响应信息为null
    }
    ```

  - 500：未知错误

    当服务器发生了一个未预料的错误时，会使用该错误码

    ```json
    {
      "code": 500,
      "detail": "internal server error", // 该消息固定
      "data": null // 由于发生了错误，因此响应信息为null
    }
    ```

    

## 用户接口

### 查询用户

请求地址：/api/user

请求方法：GET

query：

| 参数名  |     类型      | 默认值 | 是否必填 |                       说明                       |
| :-----: | :-----------: | :----: | :------: | :----------------------------------------------: |
|  query  | 大于 0 的数字 |   1    |   必填   |                       页码                       |
|  limit  |  大于0的数字  |   10   |    否    |                      页容量                      |
| keyword |  任意字符串   |   无   |    否    | 查询关键字，该关键字会用于对账号或邮箱的模糊查询 |
| enable  |     0或1      |   无   |    否    |            查询启用(1)或禁用(0)的账号            |
| isadmin |     0或1      |   无   |    否    |            查询管理员(1)或普通用户(0)            |

返回值示例：

```json
{
  "code": 0, // 无错误
  "detail": null, // 无错误详情
  "data": {
    "count": 100, // 总数据量
    "rows": [ // 当前页数据
      {
        "createdAt": 1594903826000, // 用户创建时间
        "updatedAt": 1594903826000, // 用户更新时间
        "id": 1, // 用户 id
        "loginId": "account1", // 用户账号
        "email": "example1@qq.com", // 用户邮箱
        "isAdmin": false, // 是否是管理员
        "enable": true // 账号是否启用
      }
    ]
  }
}

```

说明

- 返回的用户数组，按照创建时间的降序排序
- **重要：该接口并未对权限进行任何验证，仅提供了业务功能，前端服务器需要验证是否是管理员，只有管理员才能调用该接口**

### 注册用户

